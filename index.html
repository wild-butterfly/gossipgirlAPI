<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Registration Form</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Bilbo+Swash+Caps&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="logo-container">
      <img src="gglogo.png" alt="Gossip Girl Logo" class="logo" />
    </div>
    <div class="container">
      <div class="form-box">
        <button id="toggleRegistrationForm">Registration Form</button>
        <div id="registrationFormContainer" style="display: none">
          <form id="registrationForm">
            <label for="name">Name:</label>
            <input type="text" id="name" name="name" required /><br /><br />

            <label for="last_name">Last Name:</label>
            <input
              type="text"
              id="last_name"
              name="last_name"
              required
            /><br /><br />

            <label for="email">Email:</label>
            <input type="email" id="email" name="email" required /><br /><br />

            <button type="submit">Register</button>
          </form>
        </div>
      </div>

      <div class="form-box">
        <button id="toggleEditForm">Edit Member Form</button>
        <div id="editFormContainer" style="display: none">
          <form id="editForm">
            <label for="edit_id">ID:</label>
            <input
              type="text"
              id="edit_id"
              name="edit_id"
              required
            /><br /><br />

            <label for="edit_name">Name:</label>
            <input
              type="text"
              id="edit_name"
              name="edit_name"
              required
            /><br /><br />

            <label for="edit_last_name">Last Name:</label>
            <input
              type="text"
              id="edit_last_name"
              name="edit_last_name"
              required
            /><br /><br />

            <label for="edit_email">Email:</label>
            <input
              type="email"
              id="edit_email"
              name="edit_email"
              required
            /><br /><br />

            <button type="submit">Edit</button>
          </form>
        </div>
      </div>

      <div class="form-box">
        <button id="toggleDeleteForm">Delete Member Form</button>
        <div id="deleteFormContainer" style="display: none">
          <form id="deleteForm">
            <label for="delete_id">ID:</label>
            <input
              type="text"
              id="delete_id"
              name="delete_id"
              required
            /><br /><br />

            <button type="submit">Delete</button>
          </form>
        </div>
      </div>
    </div>

    <p id="response"></p>

    <script>
      document
        .getElementById("registrationForm")
        .addEventListener("submit", function (event) {
          event.preventDefault();

          const name = document.getElementById("name").value;
          const last_name = document.getElementById("last_name").value;
          const email = document.getElementById("email").value;

          fetch("http://localhost:3000/members", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({ name, last_name, email }),
          })
            .then((response) => response.json())
            .then((data) => {
              document.getElementById("response").innerText =
                data.message || "Registration successful!";
            })
            .catch((error) => {
              document.getElementById("response").innerText =
                "An error occurred: " + error.message;
            });
        });

      document
        .getElementById("editForm")
        .addEventListener("submit", function (event) {
          event.preventDefault();

          const id = document.getElementById("edit_id").value;
          const name = document.getElementById("edit_name").value;
          const last_name = document.getElementById("edit_last_name").value;
          const email = document.getElementById("edit_email").value;

          fetch(`http://localhost:3000/members/${id}`, {
            method: "PUT",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({ name, last_name, email }),
          })
            .then((response) => response.json())
            .then((data) => {
              document.getElementById("response").innerText =
                data.message || "Member successfully edited!";
            })
            .catch((error) => {
              document.getElementById("response").innerText =
                "An error occurred: " + error.message;
            });
        });

      document
        .getElementById("deleteForm")
        .addEventListener("submit", function (event) {
          event.preventDefault();

          const id = document.getElementById("delete_id").value;

          fetch(`http://localhost:3000/members/${id}`, {
            method: "DELETE",
            headers: {
              "Content-Type": "application/json",
            },
          })
            .then((response) => response.json())
            .then((data) => {
              document.getElementById("response").innerText =
                data.message || "Member successfully deleted!";
            })
            .catch((error) => {
              document.getElementById("response").innerText =
                "An error occurred: " + error.message;
            });
        });

      document
        .getElementById("toggleRegistrationForm")
        .addEventListener("click", function () {
          const formContainer = document.getElementById(
            "registrationFormContainer"
          );
          if (formContainer.style.display === "none") {
            formContainer.style.display = "block";
            this.innerText = "Hide Registration Form";
            window.scrollTo({ top: 0, behavior: "smooth" });
          } else {
            formContainer.style.display = "none";
            this.innerText = "Show Registration Form";
          }
        });

      document
        .getElementById("toggleEditForm")
        .addEventListener("click", function () {
          const formContainer = document.getElementById("editFormContainer");
          if (formContainer.style.display === "none") {
            formContainer.style.display = "block";
            this.innerText = "Hide Edit Member Form";
            window.scrollTo({ top: 0, behavior: "smooth" });
          } else {
            formContainer.style.display = "none";
            this.innerText = "Show Edit Member Form";
          }
        });

      document
        .getElementById("toggleDeleteForm")
        .addEventListener("click", function () {
          const formContainer = document.getElementById("deleteFormContainer");
          if (formContainer.style.display === "none") {
            formContainer.style.display = "block";
            this.innerText = "Hide Delete Member Form";
            window.scrollTo({ top: 0, behavior: "smooth" });
          } else {
            formContainer.style.display = "none";
            this.innerText = "Show Delete Member Form";
          }
        });
    </script>
  </body>
</html>
